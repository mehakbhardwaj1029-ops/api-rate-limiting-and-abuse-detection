To get rid of all the shortcomings og fixed window implementation i'll be using "token-bucket algorithm".

TOKEN BUCKET ALGORITHM:

* Each client has buckets of tokens.
* Every request by client consumes 1 token.
* But tokens keeps refilling over time at a fixed rate.
* If the bucket is left with no token the request is blocked.

Token Bucket rules (simple & precise)

1. Each user has ONE bucket
* Identified by fingerprint
* Stored in Redis

2. Bucket has a maximum capacity
* MAX_TOKENS = 60

3. Each request consumes exactly ONE token
* If token exists → allow request
* If no token → block request
* Tokens are refilled gradually over time

4. Every REFILL_INTERVAL_SECONDS = 6

* Add 1 token per interval
* Bucket never exceeds MAX_TOKENS
* First request behavior

5. If user has never made a request:

* Bucket is assumed FULL
* Then 1 token is consumed


All of this makes the algorithm handle 
* Burst traffic
* Adaptability
* Smoothing



